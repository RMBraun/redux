<html>
  <head>
    <script src="dist/redux.js"></script>
    <script src="dist/redux.devtool.loader.js" data-devtool-script="dist/redux.devtool.js"></script>
  </head>
  <body>
    <button onclick="buttonClick()">click me</button>
    <button onclick="buttonMultiClick()">click me</button>
    <pre id="text"></pre>

    <script type="text/javascript">
      const storeOneId = 'storeOne'
      Redux.init({ [storeOneId]: { count: 0 } })

      Redux.addChangeListener(newState => {
        const bodyText = document.getElementById('text')
        if (bodyText) {
          bodyText.innerHTML = JSON.stringify(newState, null, 2)
        }
      })

      Redux.createActions(storeOneId, {
        one: store => {
          store[storeOneId].count = (store[storeOneId].count || 0) + 1
          return store
        },
        two: store => {
          store[storeOneId].count = (store[storeOneId].count || 0) + 2
          return store
        },
        add: (store, payload) => {
          store[storeOneId].count = (store[storeOneId].count || 0) + payload
          return store
        },
      })

      const storeTwoId = 'storeTwoWithReallyLongName'
      Redux.init({ [storeTwoId]: { backCount: 99 } })
      Redux.createActions(storeTwoId, {
        one: store => {
          store[storeTwoId].backCount = (store[storeTwoId].backCount || 99) - 1
          return store
        },
        two: store => {
          store[storeTwoId].backCount = (store[storeTwoId].backCount || 99) - 2
          return store
        },
        sub: (store, payload) => {
          store[storeOneId].count = (store[storeOneId].count || 0) - payload
          return store
        },
      })

      Redux.callAction(storeTwoId, 'one')
      Redux.callAction(storeOneId, 'one')
      Redux.callAction(storeTwoId, 'two')
      Redux.callAction(storeOneId, 'two')
      Redux.callAction(storeTwoId, 'one')
      Redux.callAction(storeOneId, 'one')

      const storeThreeId = 'storeThree'
      Redux.createActions(storeThreeId, {
        multiStoreUpdates: store => {
          store[storeTwoId].backCount = (store[storeTwoId].backCount || 99) - 1
          store[storeOneId].count = (store[storeOneId].count || 0) + 1
          return store
        },
      })

      function buttonClick() {
        Redux.callAction(storeThreeId, 'multiStoreUpdates')
      }

      function buttonMultiClick() {
        Redux.callActions([
          Redux.chainAction(storeTwoId, 'sub', 5),
          Redux.chainAction(storeOneId, 'add', 6),
          Redux.chainAction(storeThreeId, 'multiStoreUpdates'),
          Redux.chainAction(storeTwoId, 'sub', 7),
        ])
      }
    </script>
  </body>
</html>
